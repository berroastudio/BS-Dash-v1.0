<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BS Dash - Configuración</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ====== ESTILOS UBUNTU GLASS MEJORADOS ====== */
        :root {
            --bg-primary: #2D0922;
            --bg-secondary: #1a0a15;
            --bg-card: rgba(45, 20, 44, 0.75);
            --bg-hover: rgba(85, 40, 80, 0.8);
            --border-light: rgba(255, 255, 255, 0.15);
            --border-hover: rgba(233, 84, 32, 0.6);
            --text-primary: #FFFFFF;
            --text-secondary: #E8E8E8;
            --text-muted: #AAAAAA;
            --accent-orange: #E95420;
            --accent-purple: #77216F;
            --gradient-primary: linear-gradient(135deg, #E95420, #77216F);
            --gradient-card: linear-gradient(135deg, rgba(65, 25, 60, 0.9), rgba(40, 15, 35, 0.9));
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: linear-gradient(rgba(38, 1, 83, 0.16), rgba(21, 0, 48, 0.046)), 
                        url('https://plus.unsplash.com/premium_photo-1685793804465-b12bbd8b7281?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=870');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .ubuntu-glass {
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            background: var(--gradient-card);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .ubuntu-window {
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            background: var(--gradient-card);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .window-header {
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid var(--border-light);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .window-title {
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .window-controls {
            display: flex;
            gap: 10px;
        }

        .window-control {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .window-control.close { background: #FF5F57; }
        .window-control.minimize { background: #FFBD2E; }
        .window-control.maximize { background: #28CA42; }

        .window-control:hover {
            transform: scale(1.1);
        }

        .window-content {
            padding: 25px;
            max-height: 500px;
            overflow-y: auto;
        }

        .ubuntu-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 12px 16px;
            color: var(--text-primary);
            font-family: 'Outfit', sans-serif;
            transition: all 0.3s ease;
            width: 100%;
        }

        .ubuntu-input:focus {
            outline: none;
            border-color: var(--accent-orange);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 3px rgba(233, 84, 32, 0.2);
        }

        .ubuntu-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .ubuntu-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 12px 20px;
            color: var(--text-primary);
            font-family: 'Outfit', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .ubuntu-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--border-hover);
            transform: translateY(-2px);
        }

        .ubuntu-btn-primary {
            background: var(--gradient-primary);
            border: none;
            color: white;
        }

        .ubuntu-btn-primary:hover {
            background: linear-gradient(135deg, #77216F, #E95420);
            transform: translateY(-2px);
        }

        /* Dock Interno */
        .internal-dock {
            display: flex;
            gap: 10px;
            padding: 15px;
            background: rgba(45, 20, 44, 0.5);
            border-radius: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .dock-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 80px;
            text-align: center;
        }

        .dock-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }

        .dock-item.active {
            background: var(--gradient-primary);
            transform: translateY(-3px);
        }

        .dock-item i {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .dock-item span {
            font-size: 12px;
            font-weight: 500;
        }

        /* Contenedor de Ventanas */
        .windows-container {
            min-height: 600px;
            position: relative;
        }

        .window {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 10;
        }

        .window.hidden {
            display: none;
        }

        /* Búsqueda */
        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px 45px 12px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-light);
            border-radius: 25px;
            color: var(--text-primary);
            font-family: 'Outfit', sans-serif;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-orange);
            background: rgba(255, 255, 255, 0.15);
        }

        .search-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
        }

        /* Estados */
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-active {
            background: rgba(32, 201, 151, 0.2);
            color: #20C997;
        }

        .status-inactive {
            background: rgba(255, 107, 107, 0.2);
            color: #FF6B6B;
        }

        /* Animaciones */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes windowOpen {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .animate-window-open {
            animation: windowOpen 0.3s ease-out;
        }

        /* Scrollbar personalizado */
        .window-content::-webkit-scrollbar {
            width: 6px;
        }

        .window-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .window-content::-webkit-scrollbar-thumb {
            background: var(--accent-orange);
            border-radius: 3px;
        }

        .window-content::-webkit-scrollbar-thumb:hover {
            background: var(--accent-purple);
        }

        /* Drag and Drop */
        .modulo-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            cursor: move;
            transition: all 0.3s ease;
        }

        .modulo-item:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--accent-orange);
        }

        .modulo-item.dragging {
            opacity: 0.5;
        }

        .zona-drop {
            background: rgba(255, 255, 255, 0.05);
            border: 2px dashed var(--border-light);
            border-radius: 8px;
            padding: 20px;
            min-height: 100px;
            transition: all 0.3s ease;
        }

        .zona-drop.active {
            border-color: var(--accent-orange);
            background: rgba(233, 84, 32, 0.1);
        }

        /* Configuración de Tablas */
        .config-table {
            width: 100%;
            border-collapse: collapse;
        }

        .config-table th {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 1px solid var(--border-light);
        }

        .config-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .config-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Configuración de Métodos de Pago */
        .metodo-pago-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* Configuración de Secuencias */
        .secuencia-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 16px;
            margin: 8px 0;
        }

        /* Configuración SMTP */
        .smtp-config-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }

        /* Plantillas de Email */
        .plantilla-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 16px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .plantilla-item:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--accent-orange);
        }

        /* Checkbox personalizado */
        .ubuntu-checkbox {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            border: 2px solid var(--border-light);
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .ubuntu-checkbox:checked {
            background: var(--accent-orange);
            border-color: var(--accent-orange);
        }

        .ubuntu-checkbox:checked::after {
            content: '✓';
            position: absolute;
            color: white;
            font-size: 12px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Notificaciones */
        .notificacion-global {
            transition: transform 0.3s ease;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <header class="ubuntu-glass mx-4 mt-4 mb-6">
        <div class="flex items-center justify-between p-6">
            <div class="flex items-center gap-4">
                <a href="../dashboard.html" class="ubuntu-btn">
                    <i class="bi bi-arrow-left"></i> Volver al Dashboard
                </a>
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center bg-gradient-to-br from-[#E95420] to-[#77216F]">
                        <i class="bi bi-gear text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold">Configuración del Sistema</h1>
                        <p class="text-sm text-gray-300">Administra todas las configuraciones</p>
                    </div>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <!-- Selector de Empresa -->
                <div class="flex items-center gap-2 bg-gray-800 bg-opacity-50 px-3 py-2 rounded-lg border border-gray-700">
                    <label class="text-sm font-medium">Empresa:</label>
                    <select id="empresaSwitcher" class="bg-transparent border-none outline-none text-sm text-white" onchange="cambiarEmpresa()">
                        <option value="1">Berroa Studio S.R.L.</option>
                        <option value="2">Empresa Secundaria</option>
                        <option value="3">Otra Empresa</option>
                    </select>
                </div>

                <span class="text-gray-300" id="userName">Cargando...</span>
                <button onclick="logout()" class="ubuntu-btn bg-red-500 bg-opacity-20 text-red-400 border-red-500 border-opacity-30">
                    <i class="bi bi-box-arrow-right"></i> Salir
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 pb-8">
        <!-- Barra de Búsqueda Global -->
        <div class="search-container">
            <input type="text" id="globalSearch" class="search-input" placeholder="Buscar en configuración...">
            <i class="bi bi-search search-icon"></i>
        </div>

        <!-- Dock Interno de Módulos -->
        <div class="internal-dock">
            <div class="dock-item active" onclick="abrirVentana('empresa')">
                <i class="bi bi-building"></i>
                <span>Empresa</span>
            </div>
            <div class="dock-item" onclick="abrirVentana('empresas')">
                <i class="bi bi-buildings"></i>
                <span>Multi-Empresa</span>
            </div>
            <div class="dock-item" onclick="abrirVentana('usuarios')">
                <i class="bi bi-shield-check"></i>
                <span>Usuarios</span>
            </div>
            <div class="dock-item" onclick="abrirVentana('modulos')">
                <i class="bi bi-grid-3x3"></i>
                <span>Módulos</span>
            </div>
            <div class="dock-item" onclick="abrirVentana('onedrive')">
                <i class="bi bi-microsoft"></i>
                <span>OneDrive</span>
            </div>
            <div class="dock-item" onclick="abrirVentana('smtp')">
                <i class="bi bi-envelope"></i>
                <span>SMTP</span>
            </div>
            <div class="dock-item" onclick="abrirVentana('backups')">
                <i class="bi bi-cloud-arrow-up"></i>
                <span>Backups</span>
            </div>
            <div class="dock-item" onclick="abrirVentana('sistema')">
                <i class="bi bi-cpu"></i>
                <span>Sistema</span>
            </div>
            <div class="dock-item" onclick="abrirVentana('pos')">
                <i class="bi bi-cash-coin"></i>
                <span>POS</span>
            </div>
            <div class="dock-item" onclick="abrirVentana('facturacion')">
                <i class="bi bi-receipt"></i>
                <span>Facturación</span>
            </div>
        </div>

        <!-- Contenedor de Ventanas -->
        <div class="windows-container">
            <!-- Ventana: Información de Empresa -->
            <div id="ventana-empresa" class="ubuntu-window window animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-building"></i>
                        <span>Información de la Empresa</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('empresa')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('empresa')"></div>
                        <div class="window-control close" onclick="cerrarVentana('empresa')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Nombre de la Empresa *</label>
                            <input type="text" id="empresaNombre" class="ubuntu-input" value="Berroa Studio S.R.L.">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">RNC *</label>
                            <input type="text" id="empresaRNC" class="ubuntu-input" placeholder="RNC de la empresa">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Teléfono</label>
                            <input type="text" id="empresaTelefono" class="ubuntu-input" placeholder="Teléfono">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Email</label>
                            <input type="email" id="empresaEmail" class="ubuntu-input" placeholder="Email corporativo">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-300 mb-2">Dirección</label>
                            <textarea id="empresaDireccion" class="ubuntu-input" rows="3" placeholder="Dirección completa"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Sitio Web</label>
                            <input type="url" id="empresaWebsite" class="ubuntu-input" placeholder="https://ejemplo.com">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Eslogan</label>
                            <input type="text" id="empresaEslogan" class="ubuntu-input" placeholder="Eslogan de la empresa">
                        </div>
                    </div>
                    <div class="flex justify-end mt-6 gap-3">
                        <button onclick="restablecerEmpresa()" class="ubuntu-btn bg-gray-700 bg-opacity-50 text-gray-300 border-gray-600">
                            <i class="bi bi-arrow-clockwise"></i> Restablecer
                        </button>
                        <button onclick="guardarConfigEmpresa()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-check-lg"></i> Guardar Cambios
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ventana: Gestión Multi-Empresa -->
            <div id="ventana-empresas" class="ubuntu-window window hidden animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-buildings"></i>
                        <span>Gestión Multi-Empresa</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('empresas')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('empresas')"></div>
                        <div class="window-control close" onclick="cerrarVentana('empresas')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-semibold">Empresas Registradas</h3>
                        <button onclick="abrirModalEmpresa()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-building-add"></i> Nueva Empresa
                        </button>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="gridEmpresas">
                        <!-- Las empresas se cargan aquí -->
                    </div>
                </div>
            </div>

            <!-- Ventana: Gestión de Usuarios -->
            <div id="ventana-usuarios" class="ubuntu-window window hidden animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-shield-check"></i>
                        <span>Gestión de Usuarios</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('usuarios')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('usuarios')"></div>
                        <div class="window-control close" onclick="cerrarVentana('usuarios')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-semibold">Usuarios del Sistema</h3>
                        <button onclick="abrirModalUsuario()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-person-plus"></i> Nuevo Usuario
                        </button>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="config-table">
                            <thead>
                                <tr>
                                    <th>Usuario</th>
                                    <th>Email</th>
                                    <th>Empresa</th>
                                    <th>Rol</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="tablaUsuarios">
                                <!-- Los usuarios se cargan aquí -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Ventana: Gestión de Módulos -->
            <div id="ventana-modulos" class="ubuntu-window window hidden animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-grid-3x3"></i>
                        <span>Gestión de Módulos</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('modulos')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('modulos')"></div>
                        <div class="window-control close" onclick="cerrarVentana('modulos')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Módulos Disponibles -->
                        <div class="ubuntu-glass p-4">
                            <h4 class="font-semibold mb-4">Módulos Disponibles</h4>
                            <div id="modulosDisponibles" class="zona-drop">
                                <!-- Módulos disponibles se cargan aquí -->
                            </div>
                        </div>

                        <!-- Módulos Asignados -->
                        <div class="ubuntu-glass p-4">
                            <h4 class="font-semibold mb-4">Módulos Asignados a la Empresa</h4>
                            <div id="modulosAsignados" class="zona-drop">
                                <!-- Módulos asignados se cargan aquí -->
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end mt-6">
                        <button onclick="guardarConfiguracionModulos()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-check-lg"></i> Guardar Configuración
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ventana: OneDrive -->
            <div id="ventana-onedrive" class="ubuntu-window window hidden animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-microsoft"></i>
                        <span>OneDrive Integration</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('onedrive')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('onedrive')"></div>
                        <div class="window-control close" onclick="cerrarVentana('onedrive')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <!-- Estado de Conexión -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h4 class="font-medium text-gray-300 mb-3">Estado de Conexión OneDrive:</h4>
                        <div id="onedriveStatus" class="flex items-center gap-3 mb-3">
                            <div class="w-3 h-3 rounded-full bg-orange-500 animate-pulse"></div>
                            <span class="text-orange-400">⏳ No autenticado</span>
                        </div>
                        <div id="onedriveUserInfo" class="text-sm text-gray-400 space-y-1 hidden">
                            <div><strong>Conectado como:</strong> <span id="onedriveUserName">-</span></div>
                            <div><strong>Email:</strong> <span id="onedriveUserEmail">-</span></div>
                            <div><strong>Última sincronización:</strong> <span id="onedriveLastSync">-</span></div>
                        </div>
                    </div>

                    <!-- Configuración OneDrive -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">
                                Client ID *
                                <span class="text-xs text-gray-400">(De Azure App Registration)</span>
                            </label>
                            <input type="text" id="onedriveClientId" class="ubuntu-input" 
                                   placeholder="12345678-1234-1234-1234-123456789abc">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">
                                Tenant ID
                                <span class="text-xs text-gray-400">(common para multi-tenant)</span>
                            </label>
                            <input type="text" id="onedriveTenantId" class="ubuntu-input" 
                                   placeholder="common" value="common">
                        </div>
                    </div>

                    <!-- Configuración Automática -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h5 class="font-medium text-gray-300 mb-3">Configuración Automática</h5>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Backup automático</label>
                                    <p class="text-xs text-gray-400">Crear backup automáticamente cada 24h</p>
                                </div>
                                <input type="checkbox" id="autoBackup" class="ubuntu-checkbox">
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Sincronizar en tiempo real</label>
                                    <p class="text-xs text-gray-400">Sincronizar cambios automáticamente</p>
                                </div>
                                <input type="checkbox" id="syncRealTime" class="ubuntu-checkbox">
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Capturar operaciones</label>
                                    <p class="text-xs text-gray-400">Registrar todas las operaciones en OneDrive</p>
                                </div>
                                <input type="checkbox" id="capturarOperaciones" class="ubuntu-checkbox" checked>
                            </div>
                        </div>
                    </div>

                    <!-- Acciones OneDrive -->
                    <div class="flex gap-3 flex-wrap">
                        <button onclick="saveOneDriveConfig()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-cloud-check"></i> Guardar Configuración
                        </button>
                        <button onclick="connectOneDrive()" class="ubuntu-btn bg-blue-500 bg-opacity-20 text-blue-400 border-blue-500 border-opacity-30">
                            <i class="bi bi-plug"></i> Conectar OneDrive
                        </button>
                        <button onclick="testOneDriveConnection()" class="ubuntu-btn bg-green-500 bg-opacity-20 text-green-400 border-green-500 border-opacity-30">
                            <i class="bi bi-wifi"></i> Probar Conexión
                        </button>
                        <button onclick="disconnectOneDrive()" class="ubuntu-btn bg-red-500 bg-opacity-20 text-red-400 border-red-500 border-opacity-30">
                            <i class="bi bi-plug"></i> Desconectar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ventana: SMTP -->
            <div id="ventana-smtp" class="ubuntu-window window hidden animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-envelope"></i>
                        <span>Configuración SMTP</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('smtp')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('smtp')"></div>
                        <div class="window-control close" onclick="cerrarVentana('smtp')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <!-- Estado SMTP -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h4 class="font-medium text-gray-300 mb-3">Estado del Servidor SMTP:</h4>
                        <div id="smtpStatus" class="flex items-center gap-3 mb-3">
                            <div class="w-3 h-3 rounded-full bg-red-500"></div>
                            <span class="text-red-400">No configurado</span>
                        </div>
                    </div>

                    <!-- Configuración SMTP -->
                    <div class="smtp-config-section">
                        <h5 class="font-medium text-gray-300 mb-4">Configuración del Servidor</h5>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Servidor SMTP *</label>
                                <input type="text" id="smtpServer" class="ubuntu-input" placeholder="smtp.gmail.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Puerto *</label>
                                <input type="number" id="smtpPort" class="ubuntu-input" value="587">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Email *</label>
                                <input type="email" id="smtpEmail" class="ubuntu-input" placeholder="tu-email@empresa.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Contraseña *</label>
                                <input type="password" id="smtpPassword" class="ubuntu-input" placeholder="••••••••">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Seguridad</label>
                                <select id="smtpSecurity" class="ubuntu-input">
                                    <option value="tls">TLS</option>
                                    <option value="ssl">SSL</option>
                                    <option value="none">Ninguna</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Nombre del Remitente</label>
                                <input type="text" id="smtpSenderName" class="ubuntu-input" placeholder="Mi Empresa">
                            </div>
                        </div>
                    </div>

                    <!-- Plantillas de Email -->
                    <div class="smtp-config-section">
                        <h5 class="font-medium text-gray-300 mb-4">Plantillas de Email</h5>
                        <div class="space-y-3">
                            <div class="plantilla-item" onclick="editarPlantilla('facturas')">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h6 class="font-medium">Plantilla de Facturas</h6>
                                        <p class="text-sm text-gray-400">Email para envío de facturas</p>
                                    </div>
                                    <i class="bi bi-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                            <div class="plantilla-item" onclick="editarPlantilla('cotizaciones')">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h6 class="font-medium">Plantilla de Cotizaciones</h6>
                                        <p class="text-sm text-gray-400">Email para envío de cotizaciones</p>
                                    </div>
                                    <i class="bi bi-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                            <div class="plantilla-item" onclick="editarPlantilla('notificaciones')">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h6 class="font-medium">Plantilla de Notificaciones</h6>
                                        <p class="text-sm text-gray-400">Email para notificaciones del sistema</p>
                                    </div>
                                    <i class="bi bi-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Acciones SMTP -->
                    <div class="flex gap-3 flex-wrap mt-6">
                        <button onclick="saveSMTPConfig()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-check-lg"></i> Guardar Configuración
                        </button>
                        <button onclick="testSMTPConnection()" class="ubuntu-btn bg-green-500 bg-opacity-20 text-green-400 border-green-500 border-opacity-30">
                            <i class="bi bi-wifi"></i> Probar Conexión
                        </button>
                        <button onclick="sendTestEmail()" class="ubuntu-btn bg-blue-500 bg-opacity-20 text-blue-400 border-blue-500 border-opacity-30">
                            <i class="bi bi-send"></i> Enviar Email de Prueba
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ventana: Backups -->
            <div id="ventana-backups" class="ubuntu-window window hidden animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-cloud-arrow-up"></i>
                        <span>Gestión de Backups</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('backups')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('backups')"></div>
                        <div class="window-control close" onclick="cerrarVentana('backups')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <!-- Estado de Backups -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h4 class="font-medium text-gray-300 mb-3">Estado de Backups:</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                            <div>
                                <label class="text-gray-400">Último Backup:</label>
                                <p id="lastBackup" class="text-white">Nunca</p>
                            </div>
                            <div>
                                <label class="text-gray-400">Tamaño Total:</label>
                                <p id="backupSize" class="text-white">0 MB</p>
                            </div>
                            <div>
                                <label class="text-gray-400">Backups Realizados:</label>
                                <p id="backupCount" class="text-white">0</p>
                            </div>
                        </div>
                    </div>

                    <!-- Configuración de Backups -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h5 class="font-medium text-gray-300 mb-4">Configuración de Backups</h5>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Backup automático</label>
                                    <p class="text-xs text-gray-400">Crear backup automáticamente cada 24 horas</p>
                                </div>
                                <input type="checkbox" id="backupAutomatico" class="ubuntu-checkbox">
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Comprimir backups</label>
                                    <p class="text-xs text-gray-400">Reducir tamaño de los archivos de backup</p>
                                </div>
                                <input type="checkbox" id="backupComprimir" class="ubuntu-checkbox" checked>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Encriptar backups</label>
                                    <p class="text-xs text-gray-400">Proteger backups con contraseña</p>
                                </div>
                                <input type="checkbox" id="backupEncriptar" class="ubuntu-checkbox">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Retención de Backups (días)</label>
                                <input type="number" id="backupRetencion" class="ubuntu-input" value="30" min="1" max="365">
                            </div>
                        </div>
                    </div>

                    <!-- Lista de Backups -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h5 class="font-medium text-gray-300 mb-4">Backups Existentes</h5>
                        <div id="listaBackups" class="space-y-2">
                            <div class="text-center py-4 text-gray-400">
                                <i class="bi bi-inbox text-2xl mb-2"></i>
                                <p>No hay backups realizados</p>
                            </div>
                        </div>
                    </div>

                    <!-- Acciones Backups -->
                    <div class="flex gap-3 flex-wrap">
                        <button onclick="crearBackup()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-download"></i> Crear Backup
                        </button>
                        <button onclick="programarBackup()" class="ubuntu-btn bg-purple-500 bg-opacity-20 text-purple-400 border-purple-500 border-opacity-30">
                            <i class="bi bi-clock"></i> Programar Backup
                        </button>
                        <button onclick="restaurarBackup()" class="ubuntu-btn bg-green-500 bg-opacity-20 text-green-400 border-green-500 border-opacity-30">
                            <i class="bi bi-arrow-clockwise"></i> Restaurar Backup
                        </button>
                        <button onclick="limpiarBackups()" class="ubuntu-btn bg-red-500 bg-opacity-20 text-red-400 border-red-500 border-opacity-30">
                            <i class="bi bi-trash"></i> Limpiar Backups
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ventana: Sistema -->
            <div id="ventana-sistema" class="ubuntu-window window hidden animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-cpu"></i>
                        <span>Configuración del Sistema</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('sistema')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('sistema')"></div>
                        <div class="window-control close" onclick="cerrarVentana('sistema')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <!-- Información del Sistema -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h4 class="font-medium text-gray-300 mb-4">Información del Sistema</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <label class="text-gray-400">Versión:</label>
                                <p id="systemVersion" class="text-white">BS Dash 2.0.0</p>
                            </div>
                            <div>
                                <label class="text-gray-400">Base de Datos:</label>
                                <p id="systemDatabase" class="text-white">Supabase</p>
                            </div>
                            <div>
                                <label class="text-gray-400">Empresas Registradas:</label>
                                <p id="systemEmpresas" class="text-white">3</p>
                            </div>
                            <div>
                                <label class="text-gray-400">Usuarios Activos:</label>
                                <p id="systemUsuarios" class="text-white">5</p>
                            </div>
                        </div>
                    </div>

                    <!-- Configuración General -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h5 class="font-medium text-gray-300 mb-4">Configuración General</h5>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Modo Oscuro</label>
                                    <p class="text-xs text-gray-400">Activar interfaz en modo oscuro</p>
                                </div>
                                <input type="checkbox" id="systemDarkMode" class="ubuntu-checkbox" checked>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Notificaciones</label>
                                    <p class="text-xs text-gray-400">Mostrar notificaciones del sistema</p>
                                </div>
                                <input type="checkbox" id="systemNotificaciones" class="ubuntu-checkbox" checked>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Auto-guardado</label>
                                    <p class="text-xs text-gray-400">Guardar cambios automáticamente</p>
                                </div>
                                <input type="checkbox" id="systemAutoguardado" class="ubuntu-checkbox" checked>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Idioma</label>
                                <select id="systemIdioma" class="ubuntu-input">
                                    <option value="es">Español</option>
                                    <option value="en">English</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Zona Horaria</label>
                                <select id="systemZonaHoraria" class="ubuntu-input">
                                    <option value="America/Santo_Domingo">Santo Domingo (UTC-4)</option>
                                    <option value="UTC">UTC</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Métodos de Pago -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h5 class="font-medium text-gray-300 mb-4">Métodos de Pago</h5>
                        <div id="metodosPagoContainer" class="space-y-2 mb-4">
                            <!-- Métodos de pago se cargan aquí -->
                        </div>
                        <button onclick="agregarMetodoPago()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-plus"></i> Agregar Método
                        </button>
                    </div>

                    <!-- Secuencias -->
                    <div class="ubuntu-glass p-4">
                        <h5 class="font-medium text-gray-300 mb-4">Secuencias del Sistema</h5>
                        <div class="space-y-3">
                            <div class="secuencia-item">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h6 class="font-medium">Facturas</h6>
                                        <p class="text-sm text-gray-400" id="secuenciaFacturas">FACT-001</p>
                                    </div>
                                    <button onclick="editarSecuencia('facturas')" class="ubuntu-btn text-sm">
                                        <i class="bi bi-pencil"></i> Editar
                                    </button>
                                </div>
                            </div>
                            <div class="secuencia-item">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h6 class="font-medium">Cotizaciones</h6>
                                        <p class="text-sm text-gray-400" id="secuenciaCotizaciones">COT-001</p>
                                    </div>
                                    <button onclick="editarSecuencia('cotizaciones')" class="ubuntu-btn text-sm">
                                        <i class="bi bi-pencil"></i> Editar
                                    </button>
                                </div>
                            </div>
                            <div class="secuencia-item">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h6 class="font-medium">Órdenes</h6>
                                        <p class="text-sm text-gray-400" id="secuenciaOrdenes">ORD-001</p>
                                    </div>
                                    <button onclick="editarSecuencia('ordenes')" class="ubuntu-btn text-sm">
                                        <i class="bi bi-pencil"></i> Editar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ventana: Configuración POS -->
            <div id="ventana-pos" class="ubuntu-window window hidden animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-cash-coin"></i>
                        <span>Configuración POS</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('pos')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('pos')"></div>
                        <div class="window-control close" onclick="cerrarVentana('pos')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <!-- Configuración General POS -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h4 class="font-medium text-gray-300 mb-4">Configuración General</h4>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Habilitar Descuentos</label>
                                    <p class="text-xs text-gray-400">Permitir aplicar descuentos en ventas</p>
                                </div>
                                <input type="checkbox" id="posHabilitarDescuentos" class="ubuntu-checkbox" checked>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Solicitar Cliente</label>
                                    <p class="text-xs text-gray-400">Requerir selección de cliente en ventas</p>
                                </div>
                                <input type="checkbox" id="posSolicitarCliente" class="ubuntu-checkbox">
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Impresión Automática</label>
                                    <p class="text-xs text-gray-400">Imprimir ticket automáticamente</p>
                                </div>
                                <input type="checkbox" id="posImprimirAutomatico" class="ubuntu-checkbox">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">IVA por Defecto (%)</label>
                                <input type="number" id="posIvaPorDefecto" class="ubuntu-input" value="18" min="0" max="100" step="0.1">
                            </div>
                        </div>
                    </div>

                    <!-- Configuración de Impresión -->
                    <div class="ubuntu-glass p-4">
                        <h4 class="font-medium text-gray-300 mb-4">Configuración de Impresión</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Nombre de la Impresora</label>
                                <input type="text" id="posNombreImpresora" class="ubuntu-input" placeholder="Nombre de la impresora térmica">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Ancho del Ticket (caracteres)</label>
                                <input type="number" id="posAnchoTicket" class="ubuntu-input" value="42" min="20" max="80">
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Imprimir Logo</label>
                                    <p class="text-xs text-gray-400">Incluir logo de la empresa en el ticket</p>
                                </div>
                                <input type="checkbox" id="posImprimirLogo" class="ubuntu-checkbox" checked>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end mt-6">
                        <button onclick="guardarConfigPOS()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-check-lg"></i> Guardar Configuración POS
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ventana: Configuración Facturación -->
            <div id="ventana-facturacion" class="ubuntu-window window hidden animate-window-open">
                <div class="window-header">
                    <div class="window-title">
                        <i class="bi bi-receipt"></i>
                        <span>Configuración Facturación</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizarVentana('facturacion')"></div>
                        <div class="window-control maximize" onclick="maximizarVentana('facturacion')"></div>
                        <div class="window-control close" onclick="cerrarVentana('facturacion')"></div>
                    </div>
                </div>
                <div class="window-content">
                    <!-- Configuración DGII -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h4 class="font-medium text-gray-300 mb-4">Configuración DGII</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">RNC Emisor</label>
                                <input type="text" id="facturacionRNC" class="ubuntu-input" placeholder="RNC de la empresa">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Nombre Comercial</label>
                                <input type="text" id="facturacionNombreComercial" class="ubuntu-input" placeholder="Nombre comercial">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-300 mb-2">Dirección</label>
                                <textarea id="facturacionDireccion" class="ubuntu-input" rows="2" placeholder="Dirección fiscal completa"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Configuración de Facturación -->
                    <div class="ubuntu-glass p-4 mb-6">
                        <h4 class="font-medium text-gray-300 mb-4">Configuración de Facturación</h4>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Facturación Electrónica</label>
                                    <p class="text-xs text-gray-400">Habilitar envío a DGII</p>
                                </div>
                                <input type="checkbox" id="facturacionElectronica" class="ubuntu-checkbox">
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-gray-300 font-medium">Validación RNC</label>
                                    <p class="text-xs text-gray-400">Validar RNC de clientes automáticamente</p>
                                </div>
                                <input type="checkbox" id="facturacionValidacionRNC" class="ubuntu-checkbox" checked>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Formato de Factura</label>
                                <select id="facturacionFormato" class="ubuntu-input">
                                    <option value="estandar">Estándar</option>
                                    <option value="detallado">Detallado</option>
                                    <option value="simplificado">Simplificado</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Configuración de NCF -->
                    <div class="ubuntu-glass p-4">
                        <h4 class="font-medium text-gray-300 mb-4">Configuración de NCF</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Secuencia Facturas</label>
                                <input type="text" id="facturacionSecuenciaFacturas" class="ubuntu-input" value="B01">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Secuencia Créditos</label>
                                <input type="text" id="facturacionSecuenciaCreditos" class="ubuntu-input" value="B04">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Secuencia Débitos</label>
                                <input type="text" id="facturacionSecuenciaDebitos" class="ubuntu-input" value="B03">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Secuencia Gastos</label>
                                <input type="text" id="facturacionSecuenciaGastos" class="ubuntu-input" value="B02">
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end mt-6">
                        <button onclick="guardarConfigFacturacion()" class="ubuntu-btn ubuntu-btn-primary">
                            <i class="bi bi-check-lg"></i> Guardar Configuración Facturación
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Botones de Acción Globales -->
        <div class="flex gap-4 justify-end mt-6">
            <button onclick="restablecerConfiguracion()" class="ubuntu-btn bg-gray-700 bg-opacity-50 text-gray-300 border-gray-600">
                <i class="bi bi-arrow-clockwise"></i> Restablecer Todo
            </button>
            <button onclick="guardarTodaConfiguracion()" class="ubuntu-btn ubuntu-btn-primary">
                <i class="bi bi-check-lg"></i> Guardar Todo
            </button>
        </div>
    </main>

    <!-- Modal Empresa -->
    <div id="modalEmpresa" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="ubuntu-glass p-6 w-full max-w-2xl mx-4">
            <h3 class="text-xl font-bold mb-4" id="tituloModalEmpresa">Nueva Empresa</h3>
            
            <form id="formEmpresa" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Nombre *</label>
                        <input type="text" id="empresaModalNombre" class="ubuntu-input w-full" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">RNC *</label>
                        <input type="text" id="empresaModalRNC" class="ubuntu-input w-full" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Teléfono</label>
                        <input type="text" id="empresaModalTelefono" class="ubuntu-input w-full">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Email</label>
                        <input type="email" id="empresaModalEmail" class="ubuntu-input w-full">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-300 mb-2">Dirección</label>
                        <textarea id="empresaModalDireccion" class="ubuntu-input w-full" rows="2"></textarea>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Usuario Administrador *</label>
                        <input type="text" id="empresaModalAdminUser" class="ubuntu-input w-full" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Email Administrador *</label>
                        <input type="email" id="empresaModalAdminEmail" class="ubuntu-input w-full" required>
                    </div>
                </div>

                <div class="flex justify-end gap-3 pt-4">
                    <button type="button" onclick="cerrarModalEmpresa()" class="ubuntu-btn">Cancelar</button>
                    <button type="submit" class="ubuntu-btn ubuntu-btn-primary">Guardar Empresa</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Usuario -->
    <div id="modalUsuario" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="ubuntu-glass p-6 w-full max-w-md mx-4">
            <h3 class="text-xl font-bold mb-4" id="tituloModalUsuario">Nuevo Usuario</h3>
            
            <form id="formUsuario" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Nombre Completo *</label>
                    <input type="text" id="usuarioNombre" class="ubuntu-input w-full" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Email *</label>
                    <input type="email" id="usuarioEmail" class="ubuntu-input w-full" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Usuario *</label>
                    <input type="text" id="usuarioUsername" class="ubuntu-input w-full" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Contraseña *</label>
                    <input type="password" id="usuarioPassword" class="ubuntu-input w-full" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Empresa *</label>
                    <select id="usuarioEmpresa" class="ubuntu-input w-full" required>
                        <option value="">Seleccionar empresa...</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Rol *</label>
                    <select id="usuarioRol" class="ubuntu-input w-full" required>
                        <option value="admin">Administrador</option>
                        <option value="gerente">Gerente</option>
                        <option value="vendedor">Vendedor</option>
                        <option value="inventario">Inventario</option>
                        <option value="reportes">Solo Reportes</option>
                    </select>
                </div>
                
                <div class="flex justify-end gap-3 pt-4">
                    <button type="button" onclick="cerrarModalUsuario()" class="ubuntu-btn">Cancelar</button>
                    <button type="submit" class="ubuntu-btn ubuntu-btn-primary">Guardar Usuario</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Secuencia -->
    <div id="modalSecuencia" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="ubuntu-glass p-6 w-full max-w-md mx-4">
            <h3 class="text-xl font-bold mb-4" id="tituloModalSecuencia">Editar Secuencia</h3>
            
            <form id="formSecuencia" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Prefijo *</label>
                    <input type="text" id="secuenciaPrefijo" class="ubuntu-input w-full" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Número Actual *</label>
                    <input type="number" id="secuenciaNumero" class="ubuntu-input w-full" required min="1">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Ceros a la Izquierda</label>
                    <input type="number" id="secuenciaCeros" class="ubuntu-input w-full" value="3" min="1" max="6">
                </div>

                <div class="flex justify-end gap-3 pt-4">
                    <button type="button" onclick="cerrarModalSecuencia()" class="ubuntu-btn">Cancelar</button>
                    <button type="submit" class="ubuntu-btn ubuntu-btn-primary">Guardar Secuencia</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Plantilla Email -->
    <div id="modalPlantillaEmail" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="ubuntu-glass p-6 w-full max-w-4xl mx-4">
            <h3 class="text-xl font-bold mb-4" id="tituloModalPlantilla">Editar Plantilla</h3>
            
            <form id="formPlantillaEmail" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Asunto *</label>
                    <input type="text" id="plantillaAsunto" class="ubuntu-input w-full" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Cuerpo del Email *</label>
                    <textarea id="plantillaCuerpo" class="ubuntu-input w-full" rows="12" required></textarea>
                </div>

                <div class="bg-white bg-opacity-5 rounded-lg p-4">
                    <h4 class="font-medium text-gray-300 mb-2">Variables Disponibles</h4>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-sm">
                        <code class="bg-black bg-opacity-50 px-2 py-1 rounded">{cliente_nombre}</code>
                        <code class="bg-black bg-opacity-50 px-2 py-1 rounded">{empresa_nombre}</code>
                        <code class="bg-black bg-opacity-50 px-2 py-1 rounded">{numero_factura}</code>
                        <code class="bg-black bg-opacity-50 px-2 py-1 rounded">{total}</code>
                        <code class="bg-black bg-opacity-50 px-2 py-1 rounded">{fecha}</code>
                        <code class="bg-black bg-opacity-50 px-2 py-1 rounded">{rnc}</code>
                        <code class="bg-black bg-opacity-50 px-2 py-1 rounded">{telefono}</code>
                        <code class="bg-black bg-opacity-50 px-2 py-1 rounded">{direccion}</code>
                    </div>
                </div>

                <div class="flex justify-end gap-3 pt-4">
                    <button type="button" onclick="cerrarModalPlantillaEmail()" class="ubuntu-btn">Cancelar</button>
                    <button type="submit" class="ubuntu-btn ubuntu-btn-primary">Guardar Plantilla</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../js/config-loader.js"></script>
    <script src="../js/secure-database.js"></script>
    <script src="../js/auth-system.js"></script>
    <script src="../js/database-manager.js"></script>
    <script src="../js/empresa-context.js"></script>
    <script src="../js/supabase-config.js"></script>
    <script src="../js/onedrive-manager.js"></script>
    <script src="../js/config-manager.js"></script>

</body>
</html>